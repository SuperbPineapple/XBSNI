<!DOCTYPE html>
<html lang="en">

    <head>
		<meta charset="UTF-8">
        <title>XBSNI</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">

        <script>
            function checkSerial() {

                var inputtedSerial = document.getElementById("inputSerial").value;
//to do - add nonnumber checking and test on olds. maybe rework the "cases".

             //   var checkedSerial = Number(inputtedSerial);
             //   if (checkedSerial === NaN) {
            //        window.alert("Non-number characters detected in input. Please check your input.")
             //   } else {

                //divide input into specifics, lines, countries...
                var serLine = inputtedSerial.slice(0, 1);
                var serNumOfXbox = inputtedSerial.slice(1, 7);
                var serProdYear = inputtedSerial.slice(7, 8);
                var serWeek = inputtedSerial.slice(8, 10);
                var serFactory = inputtedSerial.slice(10, 12);

                //checking
                var checkedProdYear = "";
                var checkedFactory = "";
                var checkedVersion = "";

                //service line checking (for version)
                if (serLine > 6 || serLine < 1) {
                    window.alert("Service line not found. Please check your input (the first number).");
                   // throw new Error("service line higher than expected");
                }

                //year checking
                switch (serProdYear) {
                case "1":
                    checkedProdYear = "2001";
                    break;
                case "2":
                    checkedProdYear = "2002";
                    break;
                case "3":
                    checkedProdYear = "2003";
                    break;
                case "4":
                    checkedProdYear = "2004";
                    break;
                case "5":
                    checkedProdYear = "2005";
                    break;
                default:
                    window.alert("Year not found. Please check your input (the seventh number).");
                  //  throw new Error("year not found");
                }

                //version check via year/week (complicated)
                var weekInt = Number(serWeek);
                if (weekInt > 53) {
                    window.alert("Week too high. This may impact complex version checking. Please check your input (the 10th and 11th numbers).");
                    console.warn("week too high");
                }

                var yearWeekDate = serProdYear + serWeek;

                if (yearWeekDate < 242) {
                    checkedVersion = "1.0";
                } else if (yearWeekDate > 418) {
                    checkedVersion = "Likely a 1.6/1.6b";
                } else {

                    // service line, version checking using year/week
                    //maybe add an error to catch manually-inputted values


                    switch (serLine) {
                    case "1":
                        if (yearWeekDate > 241 && yearWeekDate <= 304) {
                            checkedVersion = "1.1";
                        } else if (yearWeekDate >= 305 && yearWeekDate <= 314) {
                            checkedVersion = "1.1 - 1.3";
                        } else if (yearWeekDate >= 315 && yearWeekDate <= 330) {
                            checkedVersion = "1.3";
                        } else if (yearWeekDate >= 331 && yearWeekDate <= 411) {
                            checkedVersion = "1.4";
                        } else if (yearWeekDate == 412) {
                            checkedVersion = "1.4 - 1.6";
                        } else if (yearWeekDate >= 413 && yearWeekDate <= 418) {
                            checkedVersion = "1.6/1.6b";
                        }
                        break;

                    case "2":
                        if (yearWeekDate > 241 && yearWeekDate <= 247) {
                            checkedVersion = "1.1";
                        } else if (yearWeekDate == 248) {
                            checkedVersion = "1.1 - 1.2";
                        } else if (yearWeekDate >= 249 && yearWeekDate <= 308) {
                            checkedVersion = "1.2";
                        } else if (yearWeekDate == 309) {
                            checkedVersion = "1.2 - 1.3";
                        } else if (yearWeekDate >= 310 && yearWeekDate <= 328) {
                            checkedVersion = "1.3";
                        } else if (yearWeekDate == 329 || yearWeekDate == 330) {
                            checkedVersion = "1.3 - 1.4";
                        } else if (yearWeekDate >= 331 && yearWeekDate <= 410) {
                            checkedVersion = "1.4";
                        } else if (yearWeekDate > 410 && yearWeekDate < 419) {
                            checkedVersion = "1.4 - 1.6";
                        }
                        break;

                    case "3":
                        if (yearWeekDate > 241 && yearWeekDate <= 245) {
                            checkedVersion = "1.1";
                        } else if (yearWeekDate >= 246 && yearWeekDate <= 248) {
                            checkedVersion = "1.1 - 1.2";
                        } else if (yearWeekDate >= 249 && yearWeekDate <= 309) {
                            checkedVersion = "1.2";
                        } else if (yearWeekDate == 310) {
                            checkedVersion = "1.2 - 1.3";
                        } else if (yearWeekDate >= 311 && yearWeekDate <= 329) {
                            checkedVersion = "1.3";
                        } else if (yearWeekDate >= 330 && yearWeekDate <= 415) {
                            checkedVersion = "1.4";
                        } else if (yearWeekDate >= 416 && yearWeekDate <= 418) {
                            checkedVersion = "1.4 - 1.6";
                        }
                        break;

                    case "4":
                        if (yearWeekDate > 241 && yearWeekDate <= 251) {
                            checkedVersion = "1.1";
                        } else if (yearWeekDate >= 252 && yearWeekDate <= 313) {
                            checkedVersion = "1.1 - 1.3";
                        } else if (yearWeekDate >= 314 && yearWeekDate <= 329) {
                            checkedVersion = "1.3";
                        } else if (yearWeekDate >= 330 && yearWeekDate <= 415) {
                            checkedVersion = "1.4";
                        } else if (yearWeekDate >= 416 && yearWeekDate <= 418) {
                            checkedVersion = "1.4 - 1.6";
                        }
                        break;

                    case "5":
                        if (yearWeekDate > 241 && yearWeekDate <= 250) {
                            checkedVersion = "1.1";
                        } else if (yearWeekDate >= 251 && yearWeekDate <= 303) {
                            checkedVersion = "1.1 - 1.2";
                        } else if (yearWeekDate >= 304 && yearWeekDate <= 311) {
                            checkedVersion = "1.2";
                        } else if (yearWeekDate >= 312 && yearWeekDate <= 313) {
                            checkedVersion = "1.2 - 1.3";
                        } else if (yearWeekDate >= 314 && yearWeekDate <= 329) {
                            checkedVersion = "1.3";
                        } else if (yearWeekDate >= 330 && yearWeekDate <= 412) {
                            checkedVersion = "1.4";
                        } else if (yearWeekDate == 413) {
                            checkedVersion = "1.4 - 1.6";
                        } else if (yearWeekDate >= 414 && yearWeekDate <= 418) {
                            checkedVersion = "1.6";
                        }
                        break;

                    case "6":
                        if (yearWeekDate > 241 && yearWeekDate <= 304) {
                            checkedVersion = "1.1";
                        } else if (yearWeekDate >= 305 && yearWeekDate <= 307) {
                            checkedVersion = "1.1 - 1.2";
                        } else if (yearWeekDate == 308) {
                            checkedVersion = "1.2";
                        } else if (yearWeekDate >= 309 && yearWeekDate <= 318) {
                            checkedVersion = "1.2 - 1.3";
                        } else if (yearWeekDate >= 319 && yearWeekDate <= 329) {
                            checkedVersion = "1.3";
                        } else if (yearWeekDate >= 330 && yearWeekDate <= 411) {
                            checkedVersion = "1.4";
                        } else if (yearWeekDate >= 412 && yearWeekDate <= 418) {
                            checkedVersion = "1.6";
                        }
                        break;
                    default:
                        window.alert("Rare error occured. Details: error in version checking (switch serline)");
                        console.warn("Case not found. Pretty rare since there's a check higher.");
                    }
                }


                //factory check

                switch (serFactory) {
                case "02":
                    // pre-11/2002 will result in 1.0, post 1.1.
                    if (yearWeekDate > 241) {
                        checkedVersion = "1.1";
                    } else {
                        checkedVersion = "1.0";
                    }
                    checkedFactory = "Mexico";
                    break;
                case "03":
                    //this will always make the version 1.0
                    checkedVersion = "1.0";
                    checkedFactory = "Hungary";
                    break;
                case "05":
                    //chinese produced xboxes will always be above 1.0
                    if (checkedVersion == "1.0") {
                        window.alert("Version mismatch with factory. Please check your first or last five digits in your input. Advanced: error at case 05");
              //          throw new Error("Version mismatch. Too low for something from 05");
                    } else {
                        checkedFactory = "China";
                    }
                    break;
                case "06":
                    //taiwan produced xboxes will always be above 1.1
                    if (checkedVersion == "1.0" || checkedVersion == "1.1") {
                        window.alert("Version mismatch with factory. Please check your first or last five digits in your input. Advanced: error at case 06");
            //            throw new Error("Version mismatch. Too low for something from 06");
                    } else {
                        checkedFactory = "Taiwan";
                    }
                    break;
                default:
                    window.alert("Factory not found. Please check the last two digits in your input.");
           //         throw new Error("Factory not found. Good values are 02, 03, 05, and 06.");
                }

                //place info onto screen

                document.getElementById("SNIHEAD").innerHTML = "Serial Number Information";
                document.getElementById("serialInfoLine").innerHTML = "Line: " + serLine;
                document.getElementById("serialInfoNumber").innerHTML = "Number of Xbox: " + serNumOfXbox;
                document.getElementById("serialInfoProdYear").innerHTML = "Production Year: " + checkedProdYear;
                document.getElementById("serialInfoWeek").innerHTML = "Week Number: " + serWeek;
                document.getElementById("serialInfoFactoryCode").innerHTML = "Factory: " + checkedFactory;
                document.getElementById("versionGuess").innerHTML = "Estimated Version: " + checkedVersion;
            }
      //  }
        </script>



    </head>

    <body>
        <h2 style="color:lime;">Xbox Serial Number Info</h2>
        <p>Be wary of case swaps.</p>
        <form>
            <input type="text" maxlength="12" id="inputSerial" placeholder="111111111111">
            <br>
            <br>
            <button type="button" style="padding:6px; border-radius:12px;" onclick="checkSerial()">
                Check Serial
            </button>
        </form>
        <h3 style="display:block;" id="SNIHEAD"></h3>
        <p style="display:block;" id="serialInfoLine"></p>
        <p style="display:block;" id="serialInfoNumber"></p>
        <p style="display:block;" id="serialInfoProdYear"></p>
        <p style="display:block;" id="serialInfoWeek"></p>
        <p style="display:block;" id="serialInfoFactoryCode"></p>
        <p style="display:block;" id="versionGuess"></p>
        <h4>Designed by Superb Pineapple</h4>
        <h5>Webpage Version 1.1.6</h5>
    </body>

</html>
